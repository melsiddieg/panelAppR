#'#'@include helpers.R
#'
#' getPanelList
#'
#'A function to list available gene panels
#' @export
getPanelList <- function(){
  url <- "https://panelapp.genomicsengland.co.uk/WebServices/list_panels/"
  res <- fromJSON(url)$result
  res
}
#' getPanel
#'
#' @param panel a character vector of panel names or panel ids
#' A function to get gene panels
#' @export
getPanel <- function(panel,filter=NULL){
  url <- "https://panelapp.genomicsengland.co.uk/WebServices/get_panel/"
  panel <- paste(panel, sep = ",")
  if(!is.null(filter)){
    params <- get_qparams(filter)
    furl <- paste0(url,panel,"/?",params)
  }else{
    furl <- paste0(url,panel)
  }
  print(paste("The query url is:", furl))
  res <- fromJSON(furl)
  genes <- res$result$Genes
  # genes <- genes[,c(4:9)]
  genes

}
#'
#'getGene
#'
#' @param gene a character vector of HGNC gene symbols
#'A Function to get gene information from gene panels
#'@export
getGene <- function(gene,filter=NULL){
  url <- "https://panelapp.genomicsengland.co.uk/WebServices/search_genes/"
  gene <- paste(gene, sep = ",")
  if(!is.null(filter)){
    params <- get_qparams(filter)
    furl <- paste0(url,gene,"/?",params)
  }else{
    furl <- paste0(url,gene)
  }
  print(paste("The query url is:", furl))
  res <- fromJSON(furl)$result
  res
}
